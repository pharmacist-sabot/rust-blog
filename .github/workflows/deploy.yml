name: Deploy Rust Wasm to GitHub Pages

on:
  push:
    branches: [ "main" ]

# ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ permission ‡πÉ‡∏´‡πâ GITHUB_TOKEN ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ deploy ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Pages ‡πÑ‡∏î‡πâ
permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4 

      - name: Install Rust
        uses: actions-rs/toolchain@v1
        with:
          profile: minimal
          toolchain: stable
          target: wasm32-unknown-unknown
          override: true

      - name: Download Trunk
        uses: jetli/trunk-action@v0.5.0 
        with:
          version: 'latest'

      - name: Build with Trunk
        # *** ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô /‡∏ä‡∏∑‡πà‡∏≠-repo-‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì/ ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠ repository ‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö ***
        # ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏ñ‡πâ‡∏≤ repo ‡∏ä‡∏∑‡πà‡∏≠ "rust-blog-demo" ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô:
        # run: trunk build --release --public-url /rust-blog-demo/
        run: trunk build --release --public-url /rust-blog/

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3 
        with:
          path: dist

      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4 # üî• ‡πÅ‡∏Å‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ: ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏à‡∏≤‡∏Å v2 ‡πÄ‡∏õ‡πá‡∏ô v4
